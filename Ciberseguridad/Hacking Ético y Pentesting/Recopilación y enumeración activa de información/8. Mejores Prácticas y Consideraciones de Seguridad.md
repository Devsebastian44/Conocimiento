# Consideraciones Legales

- **Autorización**: Siempre obtener autorización por escrito
- **Alcance**: Mantenerse dentro del alcance definido
- **Documentación**: Mantener logs detallados de actividades
- **Disclosure**: Seguir protocolos de divulgación responsable

## Técnicas de Evasión

Fragmentación de paquetes:

```bash
nmap -f 192.168.1.1
```

Decoy scanning:

```bash
nmap -D RND:10 192.168.1.1
```

Source port spoofing:

```bash
nmap --source-port 53 192.168.1.1
```

Timing evasion:

```bash
nmap -T0 192.168.1.1
```


# Detección y Prevención

**Indicadores de escaneo:**

- Múltiples conexiones desde la misma IP
- Patrones de escaneo secuencial
- Conexiones a puertos inusuales
- Timeouts de conexión cortos

**Contramedidas:**

- Firewalls configurados correctamente
- Sistemas de detección de intrusiones (IDS)
- Rate limiting
- Honeypots

## Optimización de Escaneos

Para redes grandes:

```bash
# Usar múltiples threads
nmap -T4 --min-parallelism 100 192.168.1.0/24

# Excluir hosts innecesarios
nmap --exclude-file exclude.txt 192.168.1.0/24

# Usar timing agresivo
nmap -T5 192.168.1.0/24
```

Para evasión:

```bash
# Escaneo lento y sigiloso
nmap -T0 -f 192.168.1.1

# Usar decoys
nmap -D RND:10 192.168.1.1

# Randomizar orden
nmap --randomize-hosts 192.168.1.0/24
```