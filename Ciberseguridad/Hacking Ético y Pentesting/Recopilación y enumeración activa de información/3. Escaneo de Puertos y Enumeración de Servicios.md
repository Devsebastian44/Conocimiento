# Técnicas de Escaneo de Puertos

TCP SYN Scan (Stealth Scan):

```bash
nmap 192.168.1.1 -sS
```

- Scan por defecto con privilegios root
- No completa el three-way handshake
- Más sigiloso que TCP Connect
- Más rápido y eficiente

TCP Connect Scan:

```bash
nmap 192.168.1.1 -sT
```

- Scan por defecto sin privilegios root
- Completa el three-way handshake
- Más detectable en logs
- Funciona a través de proxies

UDP Scan:

```bash
nmap 192.168.1.1 -sU
```

- Escanea puertos UDP
- Más lento que TCP
- Importante para servicios como DNS, DHCP, SNMP
- Puede requerir privilegios root

TCP ACK Scan:

```bash
nmap 192.168.1.1 -sA
```

- Determina reglas de firewall
- No determina si puertos están abiertos
- Útil para mapear firewall rulesets

TCP Window Scan:

```bash
nmap 192.168.1.1 -sW
```

- Similar a ACK scan
- Examina el campo TCP Window
- Puede diferenciar puertos abiertos/cerrados en algunos sistemas

TCP Maimon Scan:

```bash
nmap 192.168.1.1 -sM
```

- Envía paquetes FIN/ACK
- Útil contra sistemas BSD antiguos
- Menos común en pentesting moderno


# Especificación de Puertos

Escaneo de puerto específico:

```bash
nmap 192.168.1.1 -p 21
```

Rango de puertos:

```bash
nmap 192.168.1.1 -p 21-100
```

Múltiples puertos TCP y UDP:

```bash
nmap 192.168.1.1 -p U:53,T:21-25,80
```

Todos los puertos:

```bash
nmap 192.168.1.1 -p-
```

Puertos por nombre de servicio:

```bash
nmap 192.168.1.1 -p http,https
```

Escaneo rápido (top 100 puertos):

```bash
nmap 192.168.1.1 -F
```

Top X puertos más comunes:

```bash
nmap 192.168.1.1 --top-ports 2000
```

Desde puerto 1 hasta 65535:

```bash
nmap 192.168.1.1 -p-65535
```

Desde puerto 0 hasta 65535:

```bash
nmap 192.168.1.1 -p0-
```


# Detección de Servicios y Versiones

Detección básica de versión:

```bash
nmap 192.168.1.1 -sV
```

- Intenta determinar la versión del servicio
- Envía probes específicos para cada servicio
- Esencial para identificar vulnerabilidades

Intensidad de detección:

```bash
nmap 192.168.1.1 -sV --version-intensity 8
```

- Nivel 0-9 (por defecto es 7)
- Mayor número = mayor precisión, más tiempo
- Útil para servicios difíciles de identificar

Modo ligero:

```bash
nmap 192.168.1.1 -sV --version-light
```

- Equivale a --version-intensity 2
- Más rápido, menos preciso
- Útil para escaneos rápidos

Modo completo:

```bash
nmap 192.168.1.1 -sV --version-all
```

- Equivale a --version-intensity 9
- Más lento, más preciso
- Para análisis detallado

Escaneo agresivo:

```bash
nmap 192.168.1.1 -A
```

- Combina: OS detection, version detection, script scanning, traceroute
- Muy ruidoso pero informativo
- Útil para análisis completo


# Detección de Sistema Operativo

Detección básica de OS:

```bash
nmap 192.168.1.1 -O
```

- Usa TCP/IP stack fingerprinting
- Requiere al menos un puerto abierto y uno cerrado
- Puede identificar OS, versión, y device type

Limitar escaneo de OS:

```bash
nmap 192.168.1.1 -O --osscan-limit
```

- Solo intenta detección si hay puertos abiertos/cerrados
- Ahorra tiempo en hosts que no responden bien

Forzar adivinanza:

```bash
nmap 192.168.1.1 -O --osscan-guess
```

- Hace que Nmap adivine más agresivamente
- Útil cuando la detección normal falla

Limitar intentos:

```bash
nmap 192.168.1.1 -O --max-os-tries 1
```

- Establece máximo número de intentos
- Acelera escaneos en redes grandes


# Timing y Performance

Plantillas de timing:

```bash
# Paranoid (0) - Evasión de IDS
nmap 192.168.1.1 -T0

# Sneaky (1) - Evasión de IDS
nmap 192.168.1.1 -T1

# Polite (2) - Usa menos ancho de banda
nmap 192.168.1.1 -T2

# Normal (3) - Velocidad por defecto
nmap 192.168.1.1 -T3

# Aggressive (4) - Red rápida y confiable
nmap 192.168.1.1 -T4

# Insane (5) - Red extraordinariamente rápida
nmap 192.168.1.1 -T5
```

Opciones de timing avanzadas:

```bash
# Timeout de host
nmap 192.168.1.1 --host-timeout 1s

# Timeouts de RTT
nmap 192.168.1.1 --min-rtt-timeout 1s --max-rtt-timeout 4m

# Tamaño de grupos de hosts
nmap 192.168.1.1 --min-hostgroup 50 --max-hostgroup 1024

# Paralelización de probes
nmap 192.168.1.1 --min-parallelism 10 --max-parallelism 1

# Delay entre probes
nmap 192.168.1.1 --scan-delay 20ms --max-scan-delay 2s

# Máximo número de reintentos
nmap 192.168.1.1 --max-retries 3

# Control de velocidad
nmap 192.168.1.1 --min-rate 100 --max-rate 100
```